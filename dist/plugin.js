!function(h,C){"object"==typeof exports&&"object"==typeof module?module.exports=C(require("ng.forms"),require("ionic.storage"),require("ionic.angular"),require("ng.core"),require("wako-app.mobile-sdk"),require("ngx-translate.core"),require("tslib"),require("ng.common"),require("rxjs")):"function"==typeof define&&define.amd?define(["ng.forms","ionic.storage","ionic.angular","ng.core","wako-app.mobile-sdk","ngx-translate.core","tslib","ng.common","rxjs"],C):"object"==typeof exports?exports.plugin=C(require("ng.forms"),require("ionic.storage"),require("ionic.angular"),require("ng.core"),require("wako-app.mobile-sdk"),require("ngx-translate.core"),require("tslib"),require("ng.common"),require("rxjs")):h.plugin=C(h["ng.forms"],h["ionic.storage"],h["ionic.angular"],h["ng.core"],h["wako-app.mobile-sdk"],h["ngx-translate.core"],h.tslib,h["ng.common"],h.rxjs)}(typeof self<"u"?self:this,(Y,h,C,ve,_e,ye,Se,Pe,ke)=>(()=>{"use strict";var Ce={122:e=>{e.exports=Y},165:e=>{e.exports=h},202:e=>{e.exports=C},264:e=>{e.exports=ve},325:e=>{e.exports=_e},555:e=>{e.exports=ye},652:e=>{e.exports=Se},714:e=>{e.exports=Pe},961:e=>{e.exports=ke}},W={};function p(e){var t=W[e];if(void 0!==t)return t.exports;var r=W[e]={exports:{}};return Ce[e](r,r.exports,p),r.exports}p.d=(e,t)=>{for(var r in t)p.o(t,r)&&!p.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},p.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),p.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var R={};p.r(R),p.d(R,{PluginModule:()=>ge,default:()=>dt});var J=p(714),m=p(202),u=p(325),s=p(264);function Q(e,t,r,n,o,i,l){try{var a=e[i](l),c=a.value}catch(d){return void r(d)}a.done?t(c):Promise.resolve(c).then(n,o)}function g(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function l(c){Q(i,n,o,l,a,"next",c)}function a(c){Q(i,n,o,l,a,"throw",c)}l(void 0)})}}var b=p(961),w=p(652);function f(e){return"function"==typeof e}const L=function Ee(e){const r=e(n=>{Error.call(n),n.stack=(new Error).stack});return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}(e=>function(r){e(this),this.message=r?`${r.length} errors occurred during unsubscription:\n${r.map((n,o)=>`${o+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=r});function X(e,t){if(e){const r=e.indexOf(t);0<=r&&e.splice(r,1)}}class y{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:r}=this;if(r)if(this._parentage=null,Array.isArray(r))for(const i of r)i.remove(this);else r.remove(this);const{initialTeardown:n}=this;if(f(n))try{n()}catch(i){t=i instanceof L?i.errors:[i]}const{_finalizers:o}=this;if(o){this._finalizers=null;for(const i of o)try{ee(i)}catch(l){t=t??[],l instanceof L?t=[...t,...l.errors]:t.push(l)}}if(t)throw new L(t)}}add(t){var r;if(t&&t!==this)if(this.closed)ee(t);else{if(t instanceof y){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}}_hasParent(t){const{_parentage:r}=this;return r===t||Array.isArray(r)&&r.includes(t)}_addParent(t){const{_parentage:r}=this;this._parentage=Array.isArray(r)?(r.push(t),r):r?[r,t]:t}_removeParent(t){const{_parentage:r}=this;r===t?this._parentage=null:Array.isArray(r)&&X(r,t)}remove(t){const{_finalizers:r}=this;r&&X(r,t),t instanceof y&&t._removeParent(this)}}function Z(e){return e instanceof y||e&&"closed"in e&&f(e.remove)&&f(e.add)&&f(e.unsubscribe)}function ee(e){f(e)?e():e.unsubscribe()}y.EMPTY=(()=>{const e=new y;return e.closed=!0,e})();const S={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},A={setTimeout(e,t,...r){const{delegate:n}=A;return n?.setTimeout?n.setTimeout(e,t,...r):setTimeout(e,t,...r)},clearTimeout(e){const{delegate:t}=A;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function te(e){A.setTimeout(()=>{const{onUnhandledError:t}=S;if(!t)throw e;t(e)})}function ne(){}const Ie=K("C",void 0,void 0);function K(e,t,r){return{kind:e,value:t,error:r}}let P=null;class D extends y{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Z(t)&&t.add(this)):this.destination=Be}static create(t,r,n){return new q(t,r,n)}next(t){this.isStopped?H(function Te(e){return K("N",e,void 0)}(t),this):this._next(t)}error(t){this.isStopped?H(function Oe(e){return K("E",void 0,e)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?H(Ie,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Me=Function.prototype.bind;function N(e,t){return Me.call(e,t)}class je{constructor(t){this.partialObserver=t}next(t){const{partialObserver:r}=this;if(r.next)try{r.next(t)}catch(n){U(n)}}error(t){const{partialObserver:r}=this;if(r.error)try{r.error(t)}catch(n){U(n)}else U(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(r){U(r)}}}class q extends D{constructor(t,r,n){let o;if(super(),f(t)||!t)o={next:t??void 0,error:r??void 0,complete:n??void 0};else{let i;this&&S.useDeprecatedNextContext?(i=Object.create(t),i.unsubscribe=()=>this.unsubscribe(),o={next:t.next&&N(t.next,i),error:t.error&&N(t.error,i),complete:t.complete&&N(t.complete,i)}):o=t}this.destination=new je(o)}}function U(e){S.useDeprecatedSynchronousErrorHandling?function Ue(e){S.useDeprecatedSynchronousErrorHandling&&P&&(P.errorThrown=!0,P.error=e)}(e):te(e)}function H(e,t){const{onStoppedNotification:r}=S;r&&A.setTimeout(()=>r(e,t))}const Be={closed:!0,next:ne,error:function Fe(e){throw e},complete:ne},z="function"==typeof Symbol&&Symbol.observable||"@@observable";function ie(e){return e}let x=(()=>{class e{constructor(r){r&&(this._subscribe=r)}lift(r){const n=new e;return n.source=this,n.operator=r,n}subscribe(r,n,o){const i=function Le(e){return e&&e instanceof D||function Re(e){return e&&f(e.next)&&f(e.error)&&f(e.complete)}(e)&&Z(e)}(r)?r:new q(r,n,o);return function Ae(e){if(S.useDeprecatedSynchronousErrorHandling){const t=!P;if(t&&(P={errorThrown:!1,error:null}),e(),t){const{errorThrown:r,error:n}=P;if(P=null,r)throw n}}else e()}(()=>{const{operator:l,source:a}=this;i.add(l?l.call(i,a):a?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(r){try{return this._subscribe(r)}catch(n){r.error(n)}}forEach(r,n){return new(n=oe(n))((o,i)=>{const l=new q({next:a=>{try{r(a)}catch(c){i(c),l.unsubscribe()}},error:i,complete:o});this.subscribe(l)})}_subscribe(r){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(r)}[z](){return this}pipe(...r){return function re(e){return 0===e.length?ie:1===e.length?e[0]:function(r){return e.reduce((n,o)=>o(n),r)}}(r)(this)}toPromise(r){return new(r=oe(r))((n,o)=>{let i;this.subscribe(l=>i=l,l=>o(l),()=>n(i))})}}return e.create=t=>new e(t),e})();function oe(e){var t;return null!==(t=e??S.Promise)&&void 0!==t?t:Promise}const He=function qe(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function se(e){if(e instanceof x)return e;if(null!=e){if(function Ke(e){return f(e[z])}(e))return function $e(e){return new x(t=>{const r=e[z]();if(f(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if((e=>e&&"number"==typeof e.length&&"function"!=typeof e)(e))return function Ye(e){return new x(t=>{for(let r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()})}(e);if(function xe(e){return f(e?.then)}(e))return function We(e){return new x(t=>{e.then(r=>{t.closed||(t.next(r),t.complete())},r=>t.error(r)).then(null,te)})}(e);if(function De(e){return Symbol.asyncIterator&&f(e?.[Symbol.asyncIterator])}(e))return le(e);if(function ze(e){return f(e?.[He])}(e))return function Je(e){return new x(t=>{for(const r of e)if(t.next(r),t.closed)return;t.complete()})}(e);if(function Ge(e){return f(e?.getReader)}(e))return function Qe(e){return le(function Ve(e){return(0,w.__asyncGenerator)(this,arguments,function*(){const r=e.getReader();try{for(;;){const{value:n,done:o}=yield(0,w.__await)(r.read());if(o)return yield(0,w.__await)(void 0);yield yield(0,w.__await)(n)}}finally{r.releaseLock()}})}(e))}(e)}throw function Ne(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}(e)}function le(e){return new x(t=>{(function Xe(e,t){var r,n,o,i;return(0,w.__awaiter)(this,void 0,void 0,function*(){try{for(r=(0,w.__asyncValues)(e);!(n=yield r.next()).done;)if(t.next(n.value),t.closed)return}catch(l){o={error:l}}finally{try{n&&!n.done&&(i=r.return)&&(yield i.call(r))}finally{if(o)throw o.error}}t.complete()})})(e,t).catch(r=>t.error(r))})}function I(e){return t=>{if(function Ze(e){return f(e?.lift)}(t))return t.lift(function(r){try{return e(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function O(e,t,r,n,o){return new et(e,t,r,n,o)}class et extends D{constructor(t,r,n,o,i,l){super(t),this.onFinalize=i,this.shouldUnsubscribe=l,this._next=r?function(a){try{r(a)}catch(c){t.error(c)}}:super._next,this._error=o?function(a){try{o(a)}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:r}=this;super.unsubscribe(),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function v(e,t){return I((r,n)=>{let o=null,i=0,l=!1;const a=()=>l&&!o&&n.complete();r.subscribe(O(n,c=>{o?.unsubscribe();let d=0;const E=i++;se(e(c,E)).subscribe(o=O(n,B=>n.next(t?t(c,B,E,d++):B),()=>{o=null,a()}))},()=>{l=!0,a()}))})}function T(e,t){return I((r,n)=>{let o=0;r.subscribe(O(n,i=>{n.next(e.call(t,i,o++))}))})}function M(e){return I((t,r)=>{let i,n=null,o=!1;n=t.subscribe(O(r,void 0,void 0,l=>{i=se(e(l,M(e)(t))),n?(n.unsubscribe(),n=null,i.subscribe(r)):o=!0})),o&&(n.unsubscribe(),n=null,i.subscribe(r))})}function ae(e,t,r){const n=f(e)||t||r?{next:e,error:t,complete:r}:e;return n?I((o,i)=>{var l;null===(l=n.subscribe)||void 0===l||l.call(n);let a=!0;o.subscribe(O(i,c=>{var d;null===(d=n.next)||void 0===d||d.call(n,c),i.next(c)},()=>{var c;a=!1,null===(c=n.complete)||void 0===c||c.call(n),i.complete()},c=>{var d;a=!1,null===(d=n.error)||void 0===d||d.call(n,c),i.error(c)},()=>{var c,d;a&&(null===(c=n.unsubscribe)||void 0===c||c.call(n)),null===(d=n.finalize)||void 0===d||d.call(n)}))}):ie}function _(...e){(0,u.wakoLog)("plugin.nomos",e)}var k=p(555);let V=(()=>{var e;class t{constructor(n,o){this.toastCtrl=n,this.translateService=o}simpleMessage(n,o,i=2e3,l="top"){this.translateService.get(n,o).subscribe(a=>{this.toastCtrl.create({message:a,mode:"ios",position:l,duration:i}).then(c=>{c.present()})})}static#e=e=()=>(this.\u0275fac=function(o){return new(o||t)(s.\u0275\u0275inject(m.ToastController),s.\u0275\u0275inject(k.TranslateService))},this.\u0275prov=s.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}))}return e(),t})();const ce="CACHE_KEY_PLUGINS";let j=(()=>{var e;class t{constructor(n,o,i,l){this.toastService=n,this.storage=o,this.actionSheetController=i,this.translateService=l}patchStorageKey(){var n=this;return g(function*(){const o=yield n.storage.get("kodi-plugins-url");o&&(yield n.storage.set(n.getStorageKeyPrefixed("kodi-plugins-url"),o),yield n.storage.remove("kodi-plugins-url"));const i=yield n.storage.get("kodi-plugins-list");i&&(yield n.storage.set(n.getStorageKeyPrefixed("kodi-plugins-list"),i),yield n.storage.remove("kodi-plugins-list"));const l=yield n.storage.get("openRemoteAfterClickOnPlay");l&&(yield n.storage.set(n.getStorageKeyPrefixed("openRemoteAfterClickOnPlay"),l),yield n.storage.remove("openRemoteAfterClickOnPlay"))})()}getStorageKeyPrefixed(n){return`nomos_${n}`}getPluginUrl(){return this.storage.get(this.getStorageKeyPrefixed("kodi-plugins-url"))}setPluginUrl(n){return this.storage.set(this.getStorageKeyPrefixed("kodi-plugins-url"),n)}getPlugins(){return this.storage.get(this.getStorageKeyPrefixed("kodi-plugins-list"))}setPlugins(n,o=!1){return this.getPlugins().then(i=>{if(i&&o){let l=Object.keys(i).length===Object.keys(n).length;l&&Object.keys(i).forEach(a=>{const c=Object.assign({},i[a]),d=Object.assign({},n[a]);c.enabled=!0,d.enabled=!0,JSON.stringify(c)!==JSON.stringify(d)&&(l=!1)}),l?_("no changes in plugins"):this.toastService.simpleMessage("toasts.pluginsUpdated"),Object.keys(i).forEach(a=>{n.hasOwnProperty(a)&&(n[a].enabled=i[a].enabled)})}return this.storage.set(this.getStorageKeyPrefixed("kodi-plugins-list"),n)})}setPluginsFromUrl(n,o=!1){return n=n.trim(),u.WakoHttpRequestService.request({url:n,method:"GET"},null,1e4,!0).pipe(v(i=>"string"==typeof i||0===Object.keys(i).length?(0,b.of)(!1):(o||Object.keys(i).forEach(l=>{i[l].enabled=!0}),(0,b.from)(this.setPlugins(i,o)).pipe(v(()=>(0,b.from)(this.setPluginUrl(n))),T(()=>!0)))),M(()=>(0,b.of)(!1)))}refreshPlugins(){u.WakoCacheService.get(ce).subscribe(n=>{n?_("check plugins later"):(this.getPluginUrl().then(o=>{o&&this.setPluginsFromUrl(o,!0).subscribe()}),u.WakoCacheService.set(ce,!0,"1d"))})}getOpenRemoteAfterClickOnPlaySetting(){return this.storage.get(this.getStorageKeyPrefixed("openRemoteAfterClickOnPlay")).then(n=>!!n)}setOpenRemoteAfterClickOnPlaySetting(n){return this.storage.set(this.getStorageKeyPrefixed("openRemoteAfterClickOnPlay"),n)}getPluginsByCategory(n){return(0,b.from)(this.getPlugins()).pipe(T(o=>{if(!o)return null;const i={};return Object.keys(o).forEach(l=>{const a=o[l];a.enabled&&("movie"===n&&a.movieUrl||"episode"===n&&a.tvUrl)&&(i[l]=a)}),i}))}getInstalledPlugins(){return u.KodiGetAddonsForm.submit().pipe(M(()=>(0,b.of)({addons:[]})),T(n=>{const o=[];return n.addons.forEach(i=>{o.push(i.addonid)}),o}))}open(n){let o={};u.KodiAppService.checkAndConnectToCurrentHost().pipe(M(i=>("hostUnreachable"===i?this.toastService.simpleMessage("toasts.kodi.hostUnreachable",{hostName:u.KodiAppService.currentHost.name},2e3):this.toastService.simpleMessage("toasts.kodi.noHost"),b.NEVER)),v(()=>(_("CONNECTED"),this.getPluginsByCategory(n.category).pipe(ae(i=>{o=i||{}})))),v(()=>this.getInstalledPlugins()),T(i=>{_("_installedPlugins",i);const l=[];return Object.keys(o).forEach(a=>{i.includes(o[a].plugin)&&l.push(a)}),l})).subscribe(i=>{if(_("supportedAndInstalledPlugins",i),0===i.length)return void this.toastService.simpleMessage("toasts.kodi.noSupportedPluginsInstalled");if(1===i.length)return void this.openOnPlugin(i[0],n);const l=[];Object.keys(o).forEach(a=>{const c=o[a];i.includes(a)&&l.push({text:c.name,handler:()=>{this.openOnPlugin(a,n)}})}),_("buttons",l),1!==l.length?this.actionSheetController.create({header:this.translateService.instant("actionSheets.kodi.openTitle"),buttons:l}).then(a=>{a.present()}):l[0].handler()})}openViaPlaylist(n,o,i){return(0,b.of)(!0).pipe(v(()=>u.KodiApiService.doHttpAction("Playlist.Clear",{playlistid:0})),v(()=>u.KodiApiService.doHttpAction("Playlist.Insert",{playlistid:0,item:{file:n},position:0})),v(()=>u.KodiAppService.stopPlayingIfAny()),v(()=>u.KodiApiService.doHttpAction("Player.open",{item:{playlistid:0}})),T(()=>(i&&u.EventService.emit(u.EventCategory.kodiRemote,u.EventName.open),o&&u.KodiAppService.openMedia$.next(o),u.EventService.emit(u.EventCategory.kodi,u.EventName.open),!0)))}openOnPlugin(n,o){this.getPlugins().then(i=>{const l=i[n],c={hostName:u.KodiApiService.host.name,pluginName:l.name},d=this.getKodiPluginParams(l,o);return(0,b.from)(this.getOpenRemoteAfterClickOnPlaySetting()).pipe(v(E=>{const B={movieIds:o.movie?o.movie.ids:null,showIds:o.show?o.show.ids:null,seasonNumber:o.episode?o.episode.seasonNumber:null,episodeNumber:o.episode?o.episode.number:null},be=`plugin://${l.plugin}${d}`;return _("Opening: "+be),this.openViaPlaylist(be,B,E)}),ae(E=>{E?this.toastService.simpleMessage("toasts.kodi.open",c):this.toastService.simpleMessage("toasts.kodi.failedToOpen")})).subscribe()})}replacePlus(n){return n?n.replace(/\s/g,"+"):""}getKodiPluginParams(n,o){if(o.movie){const i=o.movie,l={tmdbId:i.ids.tmdb,rating:i.rating,date:i.released,title:i.title,tagline:i.tagline,plot:i.overview,original_title:i.originalTitle,imdb:i.ids.imdb,year:i.year,duration:60*i.runtime,mpaa:i.certification,genres:i.genres.join(" / "),fanart:i.imagesUrl.backdropOriginal,poster:i.imagesUrl.posterOriginal,id:i.ids.tmdb,slug:"",trakt:i.ids.trakt,showTmdbId:null,seasonNumber:null,episodeNumber:null,"title_+":this.replacePlus(i.title),tvdb:null,season:null,episode:null,"clearname_+":this.replacePlus(i.title),firstaired:i.released,"plot_+":this.replacePlus(i.overview),thumbnail:i.imagesUrl.backdropOriginal,now:Date.now().toString(),banner:i.imagesUrl.backdropOriginal,epimdb:null,eptmdb:null,eptrakt:null,epid:null,network_clean:"",clearname:i.title,epyear:null,tmdb:i.ids.tmdb,episodes:null,seasons:null,series_firstaired:null,seasons_no_specials:null,status:null,premiered:i.released};return this.getPluginParams(n.movieUrl,l)}{const i=o.show,l=o.episode;let a="2019-01-01";i.firstAired&&(a=i.firstAired);let c=new Date;"string"==typeof l.firstAired&&(c=new Date(l.firstAired));const d={showTmdbId:i.ids.tmdb,seasonNumber:l.seasonNumber,episodeNumber:l.number,"title_+":this.replacePlus(l.title),year:i.year,imdb:i.ids.imdb,tvdb:+i.ids.tvdb,season:l.seasonNumber,episode:l.number,"clearname_+":this.replacePlus(i.title),firstaired:a,duration:60*l.runtime,"plot_+":this.replacePlus(l.overview),thumbnail:i.imagesUrl.backdropOriginal,id:+i.ids.tvdb,poster:i.imagesUrl.posterOriginal,fanart:i.imagesUrl.backdropOriginal,now:Date.now().toString(),banner:i.imagesUrl.backdropOriginal,epimdb:l.ids.imdb,eptmdb:0,eptrakt:0,epid:+l.ids.tvdb,genres:"",mpaa:i.certification,title:l.title,plot:l.overview,rating:l.rating,network_clean:"",clearname:i.title,epyear:c?c.getFullYear():null,slug:"",tmdb:i.ids.tmdb,trakt:i.ids.trakt,episodes:1,seasons:1,series_firstaired:a,seasons_no_specials:1,status:"Continuing",tmdbId:i.ids.tmdb,date:a,tagline:"",original_title:l.title,premiered:a};return this.getPluginParams(n.tvUrl,d)}}getPluginParams(n,o){return Object.keys(o).forEach(i=>{const l=(0,u.escapeText)(o[i]);i.match(/\+/g)||(o[i]=encodeURIComponent(l))}),(0,u.replacer)(n,o)}static#e=e=()=>(this.\u0275fac=function(o){return new(o||t)(s.\u0275\u0275inject(V),s.\u0275\u0275inject(u.WakoStorage),s.\u0275\u0275inject(m.ActionSheetController),s.\u0275\u0275inject(k.TranslateService))},this.\u0275prov=s.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}))}return e(),t})();function nt(e,t){if(1&e){const r=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"ion-button",2),s.\u0275\u0275listener("click",function(){s.\u0275\u0275restoreView(r);const o=s.\u0275\u0275nextContext();return s.\u0275\u0275resetView(o.open())}),s.\u0275\u0275element(1,"ion-icon",3),s.\u0275\u0275elementStart(2,"ion-text",4),s.\u0275\u0275text(3),s.\u0275\u0275pipe(4,"translate"),s.\u0275\u0275elementEnd()()}2&e&&(s.\u0275\u0275advance(3),s.\u0275\u0275textInterpolate(s.\u0275\u0275pipeBind1(4,1,"shared.buttonOpenKodi")))}function it(e,t){if(1&e){const r=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div",1)(1,"ion-item-option",5),s.\u0275\u0275listener("click",function(){s.\u0275\u0275restoreView(r);const o=s.\u0275\u0275nextContext();return s.\u0275\u0275resetView(o.open())}),s.\u0275\u0275elementStart(2,"div",6),s.\u0275\u0275element(3,"ion-icon",7),s.\u0275\u0275elementStart(4,"ion-text"),s.\u0275\u0275text(5," Nomos "),s.\u0275\u0275elementEnd()()()()}}let F=(()=>{var e;class t{constructor(n){this.kodiPluginService=n,this.type="button"}open(){var n=this;return g(function*(){n.kodiPluginService.open({category:n.movie?"movie":"episode",movie:n.movie,show:n.show,episode:n.episode})})()}static#e=e=()=>(this.\u0275fac=function(o){return new(o||t)(s.\u0275\u0275directiveInject(j))},this.\u0275cmp=s.\u0275\u0275defineComponent({type:t,selectors:[["wk-open-button"]],inputs:{movie:"movie",show:"show",episode:"episode",type:"type"},standalone:!1,decls:2,vars:2,consts:[["color","nomos","expand","block",1,"open-on-kodi"],[1,"ion-item-options"],["color","nomos","expand","block",1,"open-on-kodi",3,"click"],["name","play","color","light","slot","start"],["color","light"],["color","nomos",3,"click"],[1,"ion-item-detail"],["name","play"]],template:function(o,i){1&o&&(s.\u0275\u0275conditionalCreate(0,nt,5,3,"ion-button",0),s.\u0275\u0275conditionalCreate(1,it,6,0,"div",1)),2&o&&(s.\u0275\u0275conditional("button"===i.type?0:-1),s.\u0275\u0275advance(),s.\u0275\u0275conditional("item-option"===i.type?1:-1))},dependencies:[m.IonButton,m.IonIcon,m.IonItemOption,m.IonText,k.TranslatePipe],styles:[".ion-color-nomos[_ngcontent-%COMP%]{--ion-color-base: #4b1d52;--ion-color-base-rgb: 53, 66, 82;--ion-color-contrast: #ffffff;--ion-color-contrast-rgb: 255, 255, 255;--ion-color-shade: #483247;--ion-color-tint: #635260}ion-button[_ngcontent-%COMP%]{--ripple-color: var(--ion-color-nomos);--background-activated: var(--ion-color-nomos);--background-focused: var(--ion-color-nomos)}.ion-item-options[_ngcontent-%COMP%]{display:flex;height:100%}.ion-item-options[_ngcontent-%COMP%]   .ion-item-detail[_ngcontent-%COMP%]{width:60px;display:grid;text-align:center}.ion-item-options[_ngcontent-%COMP%]   .ion-item-detail[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:2em;width:100%}.ion-item-options[_ngcontent-%COMP%]   .ion-item-detail[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{margin-top:3px;font-size:8px;text-transform:none}"]}))}return e(),t})(),ue=(()=>{var e;class t extends u.MovieDetailBaseComponent{setMovie(n){this.movie=n}static#e=e=()=>(this.\u0275fac=(()=>{let n;return function(i){return(n||(n=s.\u0275\u0275getInheritedFactory(t)))(i||t)}})(),this.\u0275cmp=s.\u0275\u0275defineComponent({type:t,selectors:[["app-movie-button"]],standalone:!1,features:[s.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[[3,"movie"]],template:function(o,i){1&o&&s.\u0275\u0275element(0,"wk-open-button",0),2&o&&s.\u0275\u0275property("movie",i.movie)},dependencies:[F],encapsulation:2}))}return e(),t})(),de=(()=>{var e;class t extends u.PluginBaseService{constructor(n,o){super(),this.translate=n,this.kodiPluginService=o}initialize(){_("plugin initialized"),setTimeout(()=>{this.kodiPluginService.refreshPlugins()},1e4),this.kodiPluginService.patchStorageKey()}afterInstall(){_("plugin installed")}setTranslation(n,o){this.translate.setDefaultLang(n),this.translate.use(n),this.translate.setTranslation(n,o)}customAction(n,o){}afterEpisodeMiddleware(n,o){return Promise.resolve(void 0)}afterMovieMiddleware(n){return Promise.resolve(void 0)}afterShowMiddleware(n){return Promise.resolve(void 0)}beforeEpisodeMiddleware(n,o){return Promise.resolve(void 0)}beforeMovieMiddleware(n){return Promise.resolve(void 0)}beforeShowMiddleware(n){return Promise.resolve(void 0)}fetchExplorerFolderItem(){throw new Error("Method not implemented.")}getFileActionButtons(n,o,i,l,a,c){throw new Error("Method not implemented.")}static#e=e=()=>(this.\u0275fac=function(o){return new(o||t)(s.\u0275\u0275inject(k.TranslateService),s.\u0275\u0275inject(j))},this.\u0275prov=s.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}))}return e(),t})();var G=p(122),$=p(165);const pe=new s.InjectionToken("STORAGE_CONFIG_TOKEN");class rt extends $.Storage{constructor(){super()}create(){var t=this;return g(function*(){return t})()}defineDriver(){return g(function*(){})()}get driver(){return"noop"}get(t){return g(function*(){return null})()}set(t,r){return g(function*(){})()}remove(t){return g(function*(){})()}clear(){return g(function*(){})()}length(){return g(function*(){return 0})()}keys(){return g(function*(){return[]})()}forEach(t){return g(function*(){})()}setEncryptionKey(t){}}function ot(e,t){return(0,J.isPlatformServer)(e)?new rt:new $.Storage(t)}let st=(()=>{class e{static forRoot(r=null){return{ngModule:e,providers:[{provide:pe,useValue:r},{provide:$.Storage,useFactory:ot,deps:[s.PLATFORM_ID,pe]}]}}}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=s.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=s.\u0275\u0275defineInjector({}),e})(),fe=(()=>{var e;class t extends u.EpisodeDetailBaseComponent{setShowEpisode(n,o){this.show=n,this.episode=o}static#e=e=()=>(this.\u0275fac=(()=>{let n;return function(i){return(n||(n=s.\u0275\u0275getInheritedFactory(t)))(i||t)}})(),this.\u0275cmp=s.\u0275\u0275defineComponent({type:t,selectors:[["ng-component"]],standalone:!1,features:[s.\u0275\u0275InheritDefinitionFeature],decls:1,vars:2,consts:[[3,"show","episode"]],template:function(o,i){1&o&&s.\u0275\u0275element(0,"wk-open-button",0),2&o&&s.\u0275\u0275property("show",i.show)("episode",i.episode)},dependencies:[F],encapsulation:2}))}return e(),t})(),me=(()=>{var e;class t extends u.EpisodeDetailBaseComponent{setShowEpisode(n,o){this.show=n,this.episode=o}static#e=e=()=>(this.\u0275fac=(()=>{let n;return function(i){return(n||(n=s.\u0275\u0275getInheritedFactory(t)))(i||t)}})(),this.\u0275cmp=s.\u0275\u0275defineComponent({type:t,selectors:[["ng-component"]],standalone:!1,features:[s.\u0275\u0275InheritDefinitionFeature],decls:1,vars:2,consts:[["type","item-option",3,"show","episode"]],template:function(o,i){1&o&&s.\u0275\u0275element(0,"wk-open-button",0),2&o&&s.\u0275\u0275property("show",i.show)("episode",i.episode)},dependencies:[F],encapsulation:2}))}return e(),t})();function at(e,t){1&e&&s.\u0275\u0275element(0,"ion-spinner")}function ct(e,t){if(1&e){const r=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"ion-item")(1,"ion-label"),s.\u0275\u0275text(2),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(3,"ion-toggle",3),s.\u0275\u0275listener("ionChange",function(o){const i=s.\u0275\u0275restoreView(r).$implicit,l=s.\u0275\u0275nextContext(2);return s.\u0275\u0275resetView(l.toggleProvider(i.key,o.detail.checked))}),s.\u0275\u0275elementEnd()()}if(2&e){const r=t.$implicit;s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1("",r.name," "),s.\u0275\u0275advance(),s.\u0275\u0275property("ngModel",r.enabled)}}function ut(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"ion-list",0)(1,"ion-list-header")(2,"ion-label"),s.\u0275\u0275element(3,"ion-icon",4),s.\u0275\u0275text(4),s.\u0275\u0275pipe(5,"translate"),s.\u0275\u0275elementEnd()(),s.\u0275\u0275repeaterCreate(6,ct,4,2,"ion-item",null,s.\u0275\u0275repeaterTrackByIdentity),s.\u0275\u0275elementEnd()),2&e){const r=s.\u0275\u0275nextContext();s.\u0275\u0275advance(4),s.\u0275\u0275textInterpolate1(" ",s.\u0275\u0275pipeBind1(5,1,"pages.kodi-open-button.pluginList.header")," "),s.\u0275\u0275advance(2),s.\u0275\u0275repeater(r.pluginArray)}}let he=(()=>{var e;class t{constructor(n,o,i,l){this.kodiPluginService=n,this.alertController=o,this.translateService=i,this.toastService=l,this.pluginArray=[],this.pluginsUrl=null,this.pluginsList=null,this.isLoading=!1}ngOnInit(){this.refresh(),this.kodiPluginService.getOpenRemoteAfterClickOnPlaySetting().then(n=>{this.openRemoteAfterClickOnPlay=n})}refresh(){this.kodiPluginService.getPluginUrl().then(n=>{this.pluginsUrl=n}),this.kodiPluginService.getPlugins().then(n=>{this.pluginsList=n,this.pluginArray=[],n&&Object.keys(n).forEach(o=>{const i=n[o];this.pluginArray.push({key:o,enabled:i.enabled,name:i.name})})})}setUrl(){this.alertController.create({header:"URL",inputs:[{name:"url",type:"url",placeholder:"URL",value:this.pluginsUrl?this.pluginsUrl:""}],buttons:[{text:this.translateService.instant("alerts.cancelButton"),role:"cancel",cssClass:"secondary"},{text:"Ok",handler:n=>{this.isLoading=!0,this.kodiPluginService.setPluginsFromUrl(n.url).pipe(function lt(e){return I((t,r)=>{try{t.subscribe(r)}finally{r.add(e)}})}(()=>this.isLoading=!1)).subscribe(o=>{o?(this.toastService.simpleMessage("toasts.kodi-open-button.plugingUrlAdded"),this.refresh()):this.toastService.simpleMessage("toasts.kodi-open-button.plugingUrlFailedToAdd")})}}]}).then(n=>{n.present()})}toggleProvider(n,o){this.pluginsList[n].enabled=o,this.kodiPluginService.setPlugins(this.pluginsList)}openRemoteAfterClickOnPlayChange(n){this.openRemoteAfterClickOnPlay=n,this.kodiPluginService.setOpenRemoteAfterClickOnPlaySetting(this.openRemoteAfterClickOnPlay)}static#e=e=()=>(this.\u0275fac=function(o){return new(o||t)(s.\u0275\u0275directiveInject(j),s.\u0275\u0275directiveInject(m.AlertController),s.\u0275\u0275directiveInject(k.TranslateService),s.\u0275\u0275directiveInject(V))},this.\u0275cmp=s.\u0275\u0275defineComponent({type:t,selectors:[["ng-component"]],standalone:!1,decls:22,vars:18,consts:[["lines","full"],["name","cog","slot","start"],["button","",3,"click"],[3,"ionChange","ngModel"],["name","list","slot","start"]],template:function(o,i){1&o&&(s.\u0275\u0275elementStart(0,"ion-list",0)(1,"ion-list-header")(2,"ion-label"),s.\u0275\u0275element(3,"ion-icon",1),s.\u0275\u0275text(4),s.\u0275\u0275pipe(5,"translate"),s.\u0275\u0275elementEnd(),s.\u0275\u0275conditionalCreate(6,at,1,0,"ion-spinner"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(7,"ion-item",2),s.\u0275\u0275listener("click",function(){return i.setUrl()}),s.\u0275\u0275text(8),s.\u0275\u0275pipe(9,"translate"),s.\u0275\u0275pipe(10,"translate"),s.\u0275\u0275elementEnd()(),s.\u0275\u0275elementStart(11,"ion-list",0)(12,"ion-list-header")(13,"ion-label"),s.\u0275\u0275text(14),s.\u0275\u0275pipe(15,"translate"),s.\u0275\u0275elementEnd()(),s.\u0275\u0275elementStart(16,"ion-item")(17,"ion-label"),s.\u0275\u0275text(18),s.\u0275\u0275pipe(19,"translate"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(20,"ion-toggle",3),s.\u0275\u0275listener("ionChange",function(a){return i.openRemoteAfterClickOnPlayChange(a.detail.checked)}),s.\u0275\u0275elementEnd()()(),s.\u0275\u0275conditionalCreate(21,ut,8,3,"ion-list",0)),2&o&&(s.\u0275\u0275advance(4),s.\u0275\u0275textInterpolate1(" ",s.\u0275\u0275pipeBind1(5,8,"pages.kodi-open-button.list.header")," "),s.\u0275\u0275advance(2),s.\u0275\u0275conditional(i.isLoading?6:-1),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate2(" ",s.\u0275\u0275pipeBind1(9,10,"pages.kodi-open-button.list.pluginsUrl")," ",i.pluginsUrl?i.pluginsUrl:s.\u0275\u0275pipeBind1(10,12,"pages.kodi-open-button.list.noUrl")," "),s.\u0275\u0275advance(6),s.\u0275\u0275textInterpolate1(" ",s.\u0275\u0275pipeBind1(15,14,"pages.kodi-open-button.openRemoteList.header")," "),s.\u0275\u0275advance(4),s.\u0275\u0275textInterpolate1(" ",s.\u0275\u0275pipeBind1(19,16,"pages.kodi-open-button.openRemoteList.item")),s.\u0275\u0275advance(2),s.\u0275\u0275property("ngModel",i.openRemoteAfterClickOnPlay),s.\u0275\u0275advance(),s.\u0275\u0275conditional(i.pluginsList?21:-1))},dependencies:[G.NgControlStatus,G.NgModel,m.IonIcon,m.IonItem,m.IonLabel,m.IonList,m.IonListHeader,m.IonSpinner,m.IonToggle,m.BooleanValueAccessor,k.TranslatePipe],encapsulation:2}))}return e(),t})(),ge=(()=>{var e;class t extends u.PluginBaseModule{static#e=e=()=>(this.pluginService=de,this.settingsComponent=he,this.movieComponent=ue,this.episodeComponent=fe,this.episodeItemOptionComponent=me,this.\u0275fac=(()=>{let n;return function(i){return(n||(n=s.\u0275\u0275getInheritedFactory(t)))(i||t)}})(),this.\u0275mod=s.\u0275\u0275defineNgModule({type:t}),this.\u0275inj=s.\u0275\u0275defineInjector({providers:[de,j,V,...u.WakoProviders],imports:[J.CommonModule,G.FormsModule,m.IonicModule.forRoot(),st.forRoot({}),k.TranslateModule.forRoot()]}))}return e(),t})();const dt=ge;return R})());