!function(_,k){"object"==typeof exports&&"object"==typeof module?module.exports=k(require("ionic.angular"),require("ionic.storage"),require("ng.common"),require("ng.core"),require("ng.forms"),require("ngx-translate.core"),require("rxjs"),require("tslib"),require("wako-app.mobile-sdk")):"function"==typeof define&&define.amd?define(["ionic.angular","ionic.storage","ng.common","ng.core","ng.forms","ngx-translate.core","rxjs","tslib","wako-app.mobile-sdk"],k):"object"==typeof exports?exports.plugin=k(require("ionic.angular"),require("ionic.storage"),require("ng.common"),require("ng.core"),require("ng.forms"),require("ngx-translate.core"),require("rxjs"),require("tslib"),require("wako-app.mobile-sdk")):_.plugin=k(_["ionic.angular"],_["ionic.storage"],_["ng.common"],_["ng.core"],_["ng.forms"],_["ngx-translate.core"],_.rxjs,_.tslib,_["wako-app.mobile-sdk"])}(typeof self<"u"?self:this,(W,_,k,be,ye,Se,Pe,we,Ce)=>(()=>{"use strict";var ke={372:d=>{d.exports=W},278:d=>{d.exports=_},223:d=>{d.exports=k},888:d=>{d.exports=be},951:d=>{d.exports=ye},584:d=>{d.exports=Se},832:d=>{d.exports=Pe},748:d=>{d.exports=we},95:d=>{d.exports=Ce}},J={};function m(d){var p=J[d];if(void 0!==p)return p.exports;var c=J[d]={exports:{}};return ke[d](c,c.exports,m),c.exports}m.d=(d,p)=>{for(var c in p)m.o(p,c)&&!m.o(d,c)&&Object.defineProperty(d,c,{enumerable:!0,get:p[c]})},m.o=(d,p)=>Object.prototype.hasOwnProperty.call(d,p),m.r=d=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(d,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(d,"__esModule",{value:!0})};var K={};return(()=>{m.r(K),m.d(K,{PluginModule:()=>ve,default:()=>dt});var d=m(223),p=m(372),c=m(95),o=m(888);function Q(t,n,e,i,r,s,l){try{var a=t[s](l),u=a.value}catch(f){return void e(f)}a.done?n(u):Promise.resolve(u).then(i,r)}function X(t){return function(){var n=this,e=arguments;return new Promise(function(i,r){var s=t.apply(n,e);function l(u){Q(s,i,r,l,a,"next",u)}function a(u){Q(s,i,r,l,a,"throw",u)}l(void 0)})}}var v=m(832),h=m(748);function g(t){return"function"==typeof t}const L=function Ee(t){const e=t(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function Z(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class S{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const s of e)s.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(g(i))try{i()}catch(s){n=s instanceof L?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{te(s)}catch(l){n=n??[],l instanceof L?n=[...n,...l.errors]:n.push(l)}}if(n)throw new L(n)}}add(n){var e;if(n&&n!==this)if(this.closed)te(n);else{if(n instanceof S){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&Z(e,n)}remove(n){const{_finalizers:e}=this;e&&Z(e,n),n instanceof S&&n._removeParent(this)}}function ee(t){return t instanceof S||t&&"closed"in t&&g(t.remove)&&g(t.add)&&g(t.unsubscribe)}function te(t){g(t)?t():t.unsubscribe()}S.EMPTY=(()=>{const t=new S;return t.closed=!0,t})();const P={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},M={setTimeout(t,n,...e){const{delegate:i}=M;return i?.setTimeout?i.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=M;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function ne(t){M.setTimeout(()=>{const{onUnhandledError:n}=P;if(!n)throw t;n(t)})}function ie(){}const Oe=N("C",void 0,void 0);function N(t,n,e){return{kind:t,value:n,error:e}}let w=null;class D extends S{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,ee(n)&&n.add(this)):this.destination=Re}static create(n,e,i){return new H(n,e,i)}next(n){this.isStopped?z(function Ae(t){return N("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?z(function Te(t){return N("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?z(Oe,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const je=Function.prototype.bind;function q(t,n){return je.call(t,n)}class Fe{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(i){U(i)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(i){U(i)}else U(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){U(e)}}}class H extends D{constructor(n,e,i){let r;if(super(),g(n)||!n)r={next:n??void 0,error:e??void 0,complete:i??void 0};else{let s;this&&P.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&q(n.next,s),error:n.error&&q(n.error,s),complete:n.complete&&q(n.complete,s)}):r=n}this.destination=new Fe(r)}}function U(t){P.useDeprecatedSynchronousErrorHandling?function Ue(t){P.useDeprecatedSynchronousErrorHandling&&w&&(w.errorThrown=!0,w.error=t)}(t):ne(t)}function z(t,n){const{onStoppedNotification:e}=P;e&&M.setTimeout(()=>e(t,n))}const Re={closed:!0,next:ie,error:function Be(t){throw t},complete:ie},V="function"==typeof Symbol&&Symbol.observable||"@@observable";function re(t){return t}let x=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(e,i,r){const s=function Le(t){return t&&t instanceof D||function Ke(t){return t&&g(t.next)&&g(t.error)&&g(t.complete)}(t)&&ee(t)}(e)?e:new H(e,i,r);return function Me(t){if(P.useDeprecatedSynchronousErrorHandling){const n=!w;if(n&&(w={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:i}=w;if(w=null,e)throw i}}else t()}(()=>{const{operator:l,source:a}=this;s.add(l?l.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=se(i))((r,s)=>{const l=new H({next:a=>{try{e(a)}catch(u){s(u),l.unsubscribe()}},error:s,complete:r});this.subscribe(l)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[V](){return this}pipe(...e){return function oe(t){return 0===t.length?re:1===t.length?t[0]:function(e){return t.reduce((i,r)=>r(i),e)}}(e)(this)}toPromise(e){return new(e=se(e))((i,r)=>{let s;this.subscribe(l=>s=l,l=>r(l),()=>i(s))})}}return t.create=n=>new t(n),t})();function se(t){var n;return null!==(n=t??P.Promise)&&void 0!==n?n:Promise}const ze=function He(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function le(t){if(t instanceof x)return t;if(null!=t){if(function Ne(t){return g(t[V])}(t))return function Ye(t){return new x(n=>{const e=t[V]();if(g(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if((t=>t&&"number"==typeof t.length&&"function"!=typeof t)(t))return function We(t){return new x(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(function Ie(t){return g(t?.then)}(t))return function Je(t){return new x(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,ne)})}(t);if(function De(t){return Symbol.asyncIterator&&g(t?.[Symbol.asyncIterator])}(t))return ae(t);if(function Ve(t){return g(t?.[ze])}(t))return function Qe(t){return new x(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(function $e(t){return g(t?.getReader)}(t))return function Xe(t){return ae(function Ge(t){return(0,h.__asyncGenerator)(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:i,done:r}=yield(0,h.__await)(e.read());if(r)return yield(0,h.__await)(void 0);yield yield(0,h.__await)(i)}}finally{e.releaseLock()}})}(t))}(t)}throw function qe(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}(t)}function ae(t){return new x(n=>{(function Ze(t,n){var e,i,r,s;return(0,h.__awaiter)(this,void 0,void 0,function*(){try{for(e=(0,h.__asyncValues)(t);!(i=yield e.next()).done;)if(n.next(i.value),n.closed)return}catch(l){r={error:l}}finally{try{i&&!i.done&&(s=e.return)&&(yield s.call(e))}finally{if(r)throw r.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function E(t){return n=>{if(function et(t){return g(t?.lift)}(n))return n.lift(function(e){try{return t(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function O(t,n,e,i,r){return new tt(t,n,e,i,r)}class tt extends D{constructor(n,e,i,r,s,l){super(n),this.onFinalize=s,this.shouldUnsubscribe=l,this._next=e?function(a){try{e(a)}catch(u){n.error(u)}}:super._next,this._error=r?function(a){try{r(a)}catch(u){n.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function b(t,n){return E((e,i)=>{let r=null,s=0,l=!1;const a=()=>l&&!r&&i.complete();e.subscribe(O(i,u=>{r?.unsubscribe();let f=0;const R=s++;le(t(u,R)).subscribe(r=O(i,A=>i.next(n?n(u,A,R,f++):A),()=>{r=null,a()}))},()=>{l=!0,a()}))})}function T(t,n){return E((e,i)=>{let r=0;e.subscribe(O(i,s=>{i.next(t.call(n,s,r++))}))})}function j(t){return E((n,e)=>{let s,i=null,r=!1;i=n.subscribe(O(e,void 0,void 0,l=>{s=le(t(l,j(t)(n))),i?(i.unsubscribe(),i=null,s.subscribe(e)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(e))})}function ce(t,n,e){const i=g(t)||n||e?{next:t,error:n,complete:e}:t;return i?E((r,s)=>{var l;null===(l=i.subscribe)||void 0===l||l.call(i);let a=!0;r.subscribe(O(s,u=>{var f;null===(f=i.next)||void 0===f||f.call(i,u),s.next(u)},()=>{var u;a=!1,null===(u=i.complete)||void 0===u||u.call(i),s.complete()},u=>{var f;a=!1,null===(f=i.error)||void 0===f||f.call(i,u),s.error(u)},()=>{var u,f;a&&(null===(u=i.unsubscribe)||void 0===u||u.call(i)),null===(f=i.finalize)||void 0===f||f.call(i)}))}):re}function y(...t){(0,c.wakoLog)("plugin.nomos",t)}var C=m(584);let G=(()=>{class t{constructor(e,i){this.toastCtrl=e,this.translateService=i}simpleMessage(e,i,r=2e3,s="top"){this.translateService.get(e,i).subscribe(l=>{this.toastCtrl.create({message:l,mode:"ios",position:s,duration:r}).then(a=>{a.present()})})}}return t.\u0275fac=function(e){return new(e||t)(o.\u0275\u0275inject(p.ToastController),o.\u0275\u0275inject(C.TranslateService))},t.\u0275prov=o.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t})();const ue="CACHE_KEY_PLUGINS";let F=(()=>{class t{constructor(e,i,r,s){this.toastService=e,this.storage=i,this.actionSheetController=r,this.translateService=s}patchStorageKey(){var e=this;return X(function*(){const i=yield e.storage.get("kodi-plugins-url");i&&(yield e.storage.set(e.getStorageKeyPrefixed("kodi-plugins-url"),i),yield e.storage.remove("kodi-plugins-url"));const r=yield e.storage.get("kodi-plugins-list");r&&(yield e.storage.set(e.getStorageKeyPrefixed("kodi-plugins-list"),r),yield e.storage.remove("kodi-plugins-list"));const s=yield e.storage.get("openRemoteAfterClickOnPlay");s&&(yield e.storage.set(e.getStorageKeyPrefixed("openRemoteAfterClickOnPlay"),s),yield e.storage.remove("openRemoteAfterClickOnPlay"))})()}getStorageKeyPrefixed(e){return`nomos_${e}`}getPluginUrl(){return this.storage.get(this.getStorageKeyPrefixed("kodi-plugins-url"))}setPluginUrl(e){return this.storage.set(this.getStorageKeyPrefixed("kodi-plugins-url"),e)}getPlugins(){return this.storage.get(this.getStorageKeyPrefixed("kodi-plugins-list"))}setPlugins(e,i=!1){return this.getPlugins().then(r=>{if(r&&i){let s=Object.keys(r).length===Object.keys(e).length;s&&Object.keys(r).forEach(l=>{const a=Object.assign({},r[l]),u=Object.assign({},e[l]);a.enabled=!0,u.enabled=!0,JSON.stringify(a)!==JSON.stringify(u)&&(s=!1)}),s?y("no changes in plugins"):this.toastService.simpleMessage("toasts.pluginsUpdated"),Object.keys(r).forEach(l=>{e.hasOwnProperty(l)&&(e[l].enabled=r[l].enabled)})}return this.storage.set(this.getStorageKeyPrefixed("kodi-plugins-list"),e)})}setPluginsFromUrl(e,i=!1){return e=e.trim(),c.WakoHttpRequestService.request({url:e,method:"GET"},null,1e4,!0).pipe(b(r=>"string"==typeof r||0===Object.keys(r).length?(0,v.of)(!1):(i||Object.keys(r).forEach(s=>{r[s].enabled=!0}),(0,v.from)(this.setPlugins(r,i)).pipe(b(()=>(0,v.from)(this.setPluginUrl(e))),T(()=>!0)))),j(()=>(0,v.of)(!1)))}refreshPlugins(){c.WakoCacheService.get(ue).subscribe(e=>{e?y("check plugins later"):(this.getPluginUrl().then(i=>{i&&this.setPluginsFromUrl(i,!0).subscribe()}),c.WakoCacheService.set(ue,!0,"1d"))})}getOpenRemoteAfterClickOnPlaySetting(){return this.storage.get(this.getStorageKeyPrefixed("openRemoteAfterClickOnPlay")).then(e=>!!e)}setOpenRemoteAfterClickOnPlaySetting(e){return this.storage.set(this.getStorageKeyPrefixed("openRemoteAfterClickOnPlay"),e)}getPluginsByCategory(e){return(0,v.from)(this.getPlugins()).pipe(T(i=>{if(!i)return null;const r={};return Object.keys(i).forEach(s=>{const l=i[s];!l.enabled||("movie"===e&&l.movieUrl||"episode"===e&&l.tvUrl)&&(r[s]=l)}),r}))}getInstalledPlugins(){return c.KodiGetAddonsForm.submit().pipe(j(()=>(0,v.of)({addons:[]})),T(e=>{const i=[];return e.addons.forEach(r=>{i.push(r.addonid)}),i}))}open(e){let i={};c.KodiAppService.checkAndConnectToCurrentHost().pipe(j(r=>("hostUnreachable"===r?this.toastService.simpleMessage("toasts.kodi.hostUnreachable",{hostName:c.KodiAppService.currentHost.name},2e3):this.toastService.simpleMessage("toasts.kodi.noHost"),v.NEVER)),b(()=>(y("CONNECTED"),this.getPluginsByCategory(e.category).pipe(ce(r=>{i=r||{}})))),b(()=>this.getInstalledPlugins()),T(r=>{y("_installedPlugins",r);const s=[];return Object.keys(i).forEach(l=>{r.includes(i[l].plugin)&&s.push(l)}),s})).subscribe(r=>{if(y("supportedAndInstalledPlugins",r),0===r.length)return void this.toastService.simpleMessage("toasts.kodi.noSupportedPluginsInstalled");if(1===r.length)return void this.openOnPlugin(r[0],e);const s=[];Object.keys(i).forEach(l=>{const a=i[l];r.includes(l)&&s.push({text:a.name,handler:()=>{this.openOnPlugin(l,e)}})}),y("buttons",s),1!==s.length?this.actionSheetController.create({header:this.translateService.instant("actionSheets.kodi.openTitle"),buttons:s}).then(l=>{l.present()}):s[0].handler()})}openViaPlaylist(e,i,r){return(0,v.of)(!0).pipe(b(()=>c.KodiApiService.doHttpAction("Playlist.Clear",{playlistid:0})),b(()=>c.KodiApiService.doHttpAction("Playlist.Insert",{playlistid:0,item:{file:e},position:0})),b(()=>c.KodiAppService.stopPlayingIfAny()),b(()=>c.KodiApiService.doHttpAction("Player.open",{item:{playlistid:0}})),T(()=>(r&&c.EventService.emit(c.EventCategory.kodiRemote,c.EventName.open),i&&c.KodiAppService.openMedia$.next(i),c.EventService.emit(c.EventCategory.kodi,c.EventName.open),!0)))}openOnPlugin(e,i){this.getPlugins().then(r=>{const s=r[e],a={hostName:c.KodiApiService.host.name,pluginName:s.name},u=this.getKodiPluginParams(s,i);return(0,v.from)(this.getOpenRemoteAfterClickOnPlaySetting()).pipe(b(f=>{const R={movieIds:i.movie?i.movie.ids:null,showIds:i.show?i.show.ids:null,seasonNumber:i.episode?i.episode.seasonNumber:null,episodeNumber:i.episode?i.episode.number:null},A=`plugin://${s.plugin}${u}`;return y("Opening: "+A),this.openViaPlaylist(A,R,f)}),ce(f=>{f?this.toastService.simpleMessage("toasts.kodi.open",a):this.toastService.simpleMessage("toasts.kodi.failedToOpen")})).subscribe()})}replacePlus(e){return e?e.replace(/\s/g,"+"):""}getKodiPluginParams(e,i){if(i.movie){const r=i.movie,s={tmdbId:r.ids.tmdb,rating:r.rating,date:r.released,title:r.title,tagline:r.tagline,plot:r.overview,original_title:r.originalTitle,imdb:r.ids.imdb,year:r.year,duration:60*r.runtime,mpaa:r.certification,genres:r.genres.join(" / "),fanart:r.imagesUrl.backdropOriginal,poster:r.imagesUrl.posterOriginal,id:r.ids.tmdb,slug:"",trakt:r.ids.trakt,showTmdbId:null,seasonNumber:null,episodeNumber:null,"title_+":this.replacePlus(r.title),tvdb:null,season:null,episode:null,"clearname_+":this.replacePlus(r.title),firstaired:r.released,"plot_+":this.replacePlus(r.overview),thumbnail:r.imagesUrl.backdropOriginal,now:Date.now().toString(),banner:r.imagesUrl.backdropOriginal,epimdb:null,eptmdb:null,eptrakt:null,epid:null,network_clean:"",clearname:r.title,epyear:null,tmdb:r.ids.tmdb,episodes:null,seasons:null,series_firstaired:null,seasons_no_specials:null,status:null,premiered:r.released};return this.getPluginParams(e.movieUrl,s)}{const r=i.show,s=i.episode;let l="2019-01-01";r.firstAired&&(l=r.firstAired);let a=new Date;"string"==typeof s.firstAired&&(a=new Date(s.firstAired));const u={showTmdbId:r.ids.tmdb,seasonNumber:s.seasonNumber,episodeNumber:s.number,"title_+":this.replacePlus(s.title),year:r.year,imdb:r.ids.imdb,tvdb:+r.ids.tvdb,season:s.seasonNumber,episode:s.number,"clearname_+":this.replacePlus(r.title),firstaired:l,duration:60*s.runtime,"plot_+":this.replacePlus(s.overview),thumbnail:r.imagesUrl.backdropOriginal,id:+r.ids.tvdb,poster:r.imagesUrl.posterOriginal,fanart:r.imagesUrl.backdropOriginal,now:Date.now().toString(),banner:r.imagesUrl.backdropOriginal,epimdb:s.ids.imdb,eptmdb:0,eptrakt:0,epid:+s.ids.tvdb,genres:"",mpaa:r.certification,title:s.title,plot:s.overview,rating:s.rating,network_clean:"",clearname:r.title,epyear:a?a.getFullYear():null,slug:"",tmdb:r.ids.tmdb,trakt:r.ids.trakt,episodes:1,seasons:1,series_firstaired:l,seasons_no_specials:1,status:"Continuing",tmdbId:r.ids.tmdb,date:l,tagline:"",original_title:s.title,premiered:l};return this.getPluginParams(e.tvUrl,u)}}getPluginParams(e,i){return Object.keys(i).forEach(r=>{const s=(0,c.escapeText)(i[r]);r.match(/\+/g)||(i[r]=encodeURIComponent(s))}),(0,c.replacer)(e,i)}}return t.\u0275fac=function(e){return new(e||t)(o.\u0275\u0275inject(G),o.\u0275\u0275inject(c.WakoStorage),o.\u0275\u0275inject(p.ActionSheetController),o.\u0275\u0275inject(C.TranslateService))},t.\u0275prov=o.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t})();function it(t,n){if(1&t){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementContainerStart(0),o.\u0275\u0275elementStart(1,"ion-button",1),o.\u0275\u0275listener("click",function(){o.\u0275\u0275restoreView(e);const r=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(r.open())}),o.\u0275\u0275element(2,"ion-icon",2),o.\u0275\u0275elementStart(3,"ion-text",3),o.\u0275\u0275text(4),o.\u0275\u0275pipe(5,"translate"),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementContainerEnd()}2&t&&(o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(5,1,"shared.buttonOpenKodi")))}function rt(t,n){if(1&t){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementContainerStart(0),o.\u0275\u0275elementStart(1,"div",4)(2,"ion-item-option",5),o.\u0275\u0275listener("click",function(){o.\u0275\u0275restoreView(e);const r=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(r.open())}),o.\u0275\u0275elementStart(3,"div",6),o.\u0275\u0275element(4,"ion-icon",7),o.\u0275\u0275elementStart(5,"ion-text"),o.\u0275\u0275text(6," Nomos "),o.\u0275\u0275elementEnd()()()(),o.\u0275\u0275elementContainerEnd()}}let B=(()=>{class t{constructor(e){this.kodiPluginService=e,this.type="button"}open(){var e=this;return X(function*(){e.kodiPluginService.open({category:e.movie?"movie":"episode",movie:e.movie,show:e.show,episode:e.episode})})()}}return t.\u0275fac=function(e){return new(e||t)(o.\u0275\u0275directiveInject(F))},t.\u0275cmp=o.\u0275\u0275defineComponent({type:t,selectors:[["wk-open-button"]],inputs:{movie:"movie",show:"show",episode:"episode",type:"type"},decls:2,vars:2,consts:[[4,"ngIf"],["color","nomos","expand","block",1,"open-on-kodi",3,"click"],["name","play","color","light","slot","start"],["color","light"],[1,"ion-item-options"],["color","nomos",3,"click"],[1,"ion-item-detail"],["name","play"]],template:function(e,i){1&e&&(o.\u0275\u0275template(0,it,6,3,"ng-container",0),o.\u0275\u0275template(1,rt,7,0,"ng-container",0)),2&e&&(o.\u0275\u0275property("ngIf","button"===i.type),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf","item-option"===i.type))},dependencies:[d.NgIf,p.IonButton,p.IonIcon,p.IonItemOption,p.IonText,C.TranslatePipe],styles:[".ion-color-nomos[_ngcontent-%COMP%]{--ion-color-base: #4b1d52;--ion-color-base-rgb: 53, 66, 82;--ion-color-contrast: #ffffff;--ion-color-contrast-rgb: 255, 255, 255;--ion-color-shade: #483247;--ion-color-tint: #635260}ion-button[_ngcontent-%COMP%]{--ripple-color: var(--ion-color-nomos);--background-activated: var(--ion-color-nomos);--background-focused: var(--ion-color-nomos)}.ion-item-options[_ngcontent-%COMP%]{display:flex;height:100%}.ion-item-options[_ngcontent-%COMP%]   .ion-item-detail[_ngcontent-%COMP%]{width:60px;display:grid;text-align:center}.ion-item-options[_ngcontent-%COMP%]   .ion-item-detail[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:2em;width:100%}.ion-item-options[_ngcontent-%COMP%]   .ion-item-detail[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{margin-top:3px;font-size:8px;text-transform:none}"]}),t})(),de=(()=>{class t extends c.MovieDetailBaseComponent{setMovie(e){this.movie=e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=o.\u0275\u0275getInheritedFactory(t)))(i||t)}}(),t.\u0275cmp=o.\u0275\u0275defineComponent({type:t,selectors:[["app-movie-button"]],features:[o.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[[3,"movie"]],template:function(e,i){1&e&&o.\u0275\u0275element(0,"wk-open-button",0),2&e&&o.\u0275\u0275property("movie",i.movie)},dependencies:[B]}),t})(),pe=(()=>{class t extends c.PluginBaseService{constructor(e,i){super(),this.translate=e,this.kodiPluginService=i}initialize(){y("plugin initialized"),setTimeout(()=>{this.kodiPluginService.refreshPlugins()},1e4),this.kodiPluginService.patchStorageKey()}afterInstall(){y("plugin installed")}setTranslation(e,i){this.translate.setDefaultLang(e),this.translate.use(e),this.translate.setTranslation(e,i)}customAction(e,i){}afterEpisodeMiddleware(e,i){return Promise.resolve(void 0)}afterMovieMiddleware(e){return Promise.resolve(void 0)}afterShowMiddleware(e){return Promise.resolve(void 0)}beforeEpisodeMiddleware(e,i){return Promise.resolve(void 0)}beforeMovieMiddleware(e){return Promise.resolve(void 0)}beforeShowMiddleware(e){return Promise.resolve(void 0)}fetchExplorerFolderItem(){throw new Error("Method not implemented.")}getFileActionButtons(e,i,r,s,l,a){throw new Error("Method not implemented.")}}return t.\u0275fac=function(e){return new(e||t)(o.\u0275\u0275inject(C.TranslateService),o.\u0275\u0275inject(F))},t.\u0275prov=o.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t})();var fe,$=m(951),Y=m(278);const me=new o.InjectionToken("STORAGE_CONFIG_TOKEN");class ot extends Y.Storage{constructor(){super()}create(){return(0,h.__awaiter)(this,void 0,void 0,function*(){return this})}defineDriver(){return(0,h.__awaiter)(this,void 0,void 0,function*(){})}get driver(){return"noop"}get(n){return(0,h.__awaiter)(this,void 0,void 0,function*(){return null})}set(n,e){return(0,h.__awaiter)(this,void 0,void 0,function*(){})}remove(n){return(0,h.__awaiter)(this,void 0,void 0,function*(){})}clear(){return(0,h.__awaiter)(this,void 0,void 0,function*(){})}length(){return(0,h.__awaiter)(this,void 0,void 0,function*(){return 0})}keys(){return(0,h.__awaiter)(this,void 0,void 0,function*(){return[]})}forEach(n){return(0,h.__awaiter)(this,void 0,void 0,function*(){})}setEncryptionKey(n){}}function st(t){return(0,d.isPlatformServer)(this.platformId)?new ot:new Y.Storage(t)}let I=fe=class{static forRoot(n=null){return{ngModule:fe,providers:[{provide:me,useValue:n},{provide:Y.Storage,useFactory:st,deps:[me]}]}}};I.\u0275fac=function(n){return new(n||I)},I.\u0275mod=o.\u0275\u0275defineNgModule({type:I}),I.\u0275inj=o.\u0275\u0275defineInjector({});let ge=(()=>{class t extends c.EpisodeDetailBaseComponent{setShowEpisode(e,i){this.show=e,this.episode=i}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=o.\u0275\u0275getInheritedFactory(t)))(i||t)}}(),t.\u0275cmp=o.\u0275\u0275defineComponent({type:t,selectors:[["ng-component"]],features:[o.\u0275\u0275InheritDefinitionFeature],decls:1,vars:2,consts:[[3,"show","episode"]],template:function(e,i){1&e&&o.\u0275\u0275element(0,"wk-open-button",0),2&e&&o.\u0275\u0275property("show",i.show)("episode",i.episode)},dependencies:[B]}),t})(),he=(()=>{class t extends c.EpisodeDetailBaseComponent{setShowEpisode(e,i){this.show=e,this.episode=i}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=o.\u0275\u0275getInheritedFactory(t)))(i||t)}}(),t.\u0275cmp=o.\u0275\u0275defineComponent({type:t,selectors:[["ng-component"]],features:[o.\u0275\u0275InheritDefinitionFeature],decls:1,vars:2,consts:[["type","item-option",3,"show","episode"]],template:function(e,i){1&e&&o.\u0275\u0275element(0,"wk-open-button",0),2&e&&o.\u0275\u0275property("show",i.show)("episode",i.episode)},dependencies:[B]}),t})();function at(t,n){1&t&&o.\u0275\u0275element(0,"ion-spinner")}function ct(t,n){if(1&t){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"ion-item")(1,"ion-label"),o.\u0275\u0275text(2),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(3,"ion-toggle",4),o.\u0275\u0275listener("ionChange",function(r){const l=o.\u0275\u0275restoreView(e).$implicit,a=o.\u0275\u0275nextContext(2);return o.\u0275\u0275resetView(a.toggleProvider(l.key,r.detail.checked))}),o.\u0275\u0275elementEnd()()}if(2&t){const e=n.$implicit;o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate1("",e.name," "),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngModel",e.enabled)}}function ut(t,n){if(1&t&&(o.\u0275\u0275elementStart(0,"ion-list",0)(1,"ion-list-header")(2,"ion-label"),o.\u0275\u0275element(3,"ion-icon",6),o.\u0275\u0275text(4),o.\u0275\u0275pipe(5,"translate"),o.\u0275\u0275elementEnd()(),o.\u0275\u0275template(6,ct,4,2,"ion-item",7),o.\u0275\u0275elementEnd()),2&t){const e=o.\u0275\u0275nextContext();o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(5,2,"pages.kodi-open-button.pluginList.header")," "),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngForOf",e.pluginArray)}}let _e=(()=>{class t{constructor(e,i,r,s){this.kodiPluginService=e,this.alertController=i,this.translateService=r,this.toastService=s,this.pluginArray=[],this.pluginsUrl=null,this.pluginsList=null,this.isLoading=!1}ngOnInit(){this.refresh(),this.kodiPluginService.getOpenRemoteAfterClickOnPlaySetting().then(e=>{this.openRemoteAfterClickOnPlay=e})}refresh(){this.kodiPluginService.getPluginUrl().then(e=>{this.pluginsUrl=e}),this.kodiPluginService.getPlugins().then(e=>{this.pluginsList=e,this.pluginArray=[],e&&Object.keys(e).forEach(i=>{const r=e[i];this.pluginArray.push({key:i,enabled:r.enabled,name:r.name})})})}setUrl(){this.alertController.create({header:"URL",inputs:[{name:"url",type:"url",placeholder:"URL",value:this.pluginsUrl?this.pluginsUrl:""}],buttons:[{text:this.translateService.instant("alerts.cancelButton"),role:"cancel",cssClass:"secondary"},{text:"Ok",handler:e=>{this.isLoading=!0,this.kodiPluginService.setPluginsFromUrl(e.url).pipe(function lt(t){return E((n,e)=>{try{n.subscribe(e)}finally{e.add(t)}})}(()=>this.isLoading=!1)).subscribe(i=>{i?(this.toastService.simpleMessage("toasts.kodi-open-button.plugingUrlAdded"),this.refresh()):this.toastService.simpleMessage("toasts.kodi-open-button.plugingUrlFailedToAdd")})}}]}).then(e=>{e.present()})}toggleProvider(e,i){this.pluginsList[e].enabled=i,this.kodiPluginService.setPlugins(this.pluginsList)}openRemoteAfterClickOnPlayChange(e){this.openRemoteAfterClickOnPlay=e,this.kodiPluginService.setOpenRemoteAfterClickOnPlaySetting(this.openRemoteAfterClickOnPlay)}}return t.\u0275fac=function(e){return new(e||t)(o.\u0275\u0275directiveInject(F),o.\u0275\u0275directiveInject(p.AlertController),o.\u0275\u0275directiveInject(C.TranslateService),o.\u0275\u0275directiveInject(G))},t.\u0275cmp=o.\u0275\u0275defineComponent({type:t,selectors:[["ng-component"]],decls:22,vars:18,consts:[["lines","full"],["name","cog","slot","start"],[4,"ngIf"],["button","",3,"click"],[3,"ngModel","ionChange"],["lines","full",4,"ngIf"],["name","list","slot","start"],[4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(o.\u0275\u0275elementStart(0,"ion-list",0)(1,"ion-list-header")(2,"ion-label"),o.\u0275\u0275element(3,"ion-icon",1),o.\u0275\u0275text(4),o.\u0275\u0275pipe(5,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275template(6,at,1,0,"ion-spinner",2),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(7,"ion-item",3),o.\u0275\u0275listener("click",function(){return i.setUrl()}),o.\u0275\u0275text(8),o.\u0275\u0275pipe(9,"translate"),o.\u0275\u0275pipe(10,"translate"),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementStart(11,"ion-list",0)(12,"ion-list-header")(13,"ion-label"),o.\u0275\u0275text(14),o.\u0275\u0275pipe(15,"translate"),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementStart(16,"ion-item")(17,"ion-label"),o.\u0275\u0275text(18),o.\u0275\u0275pipe(19,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(20,"ion-toggle",4),o.\u0275\u0275listener("ionChange",function(s){return i.openRemoteAfterClickOnPlayChange(s.detail.checked)}),o.\u0275\u0275elementEnd()()(),o.\u0275\u0275template(21,ut,7,4,"ion-list",5)),2&e&&(o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(5,8,"pages.kodi-open-button.list.header")," "),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",i.isLoading),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate2(" ",o.\u0275\u0275pipeBind1(9,10,"pages.kodi-open-button.list.pluginsUrl")," ",i.pluginsUrl?i.pluginsUrl:o.\u0275\u0275pipeBind1(10,12,"pages.kodi-open-button.list.noUrl")," "),o.\u0275\u0275advance(6),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(15,14,"pages.kodi-open-button.openRemoteList.header")," "),o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(19,16,"pages.kodi-open-button.openRemoteList.item"),""),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngModel",i.openRemoteAfterClickOnPlay),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",i.pluginsList))},dependencies:[d.NgForOf,d.NgIf,$.NgControlStatus,$.NgModel,p.IonIcon,p.IonItem,p.IonLabel,p.IonList,p.IonListHeader,p.IonSpinner,p.IonToggle,p.BooleanValueAccessor,C.TranslatePipe]}),t})(),ve=(()=>{class t extends c.PluginBaseModule{}return t.pluginService=pe,t.settingsComponent=_e,t.movieComponent=de,t.episodeComponent=ge,t.episodeItemOptionComponent=he,t.\u0275fac=function(){let n;return function(i){return(n||(n=o.\u0275\u0275getInheritedFactory(t)))(i||t)}}(),t.\u0275mod=o.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=o.\u0275\u0275defineInjector({providers:[pe,F,G,...c.WakoProviders],imports:[d.CommonModule,$.FormsModule,p.IonicModule.forRoot(),I.forRoot({}),C.TranslateModule.forRoot()]}),t})();const dt=ve})(),K})());